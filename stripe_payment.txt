								---STRIPE CLIENT---

import StripeCheckout from 'react-stripe-checkout';
import keys from '../config/keys';

const makePaymentStripe = async (token) => {
        //? we will get token by default
        const body = {
          data
        };
    
        try {
          const {data} = await axios.post('/payment', body);
          if (data.error) {
            toast.error(data.error);
          } else {
            toast.success("Order Successfully Created. Check email for details");
            router.push("/cart/AddToCart");
          }
        } catch (err) {
          toast.error("Error making payment");
        }
};
        <StripeCheckout
          stripeKey={keys.stripePublisherKey} // publisher key
          token={makePaymentStripe}
          name='Buy Ticket'
          amount={parseInt(price) * 100} // to get amount on dollars
          shippingAddress
          billingAddress={false}
        >
          <button id="stripeBtn">Stripe Pay With Card</button>
        </StripeCheckout>

								---STRIPE SERVER---

import { v4 as uuidv4 } from 'uuid';
import Stripe from 'stripe';
const stripe = new Stripe(process.env.STRIPE_SECRET_KEY);

export const productPayment = async (req, res) => {
    const { price, events, token } = req.body;
  
    const idempotencyKey = uuidv4(); // to be unique
  
    //! token is something automatically generated from the client side and sent to here
  
    let customer;
    try {
      customer = await stripe.customers.create({
        email: token.email,
        source: token.id,
      });
    } catch (error) {
        return res.json({
            error: 'Error Creating Customer: ' + error
        })
    //   console.log('Error coming from creating customer: ' + error);
    }
  
    let chargesResult;
    try {
      chargesResult = await stripe.charges.create(
        {
          amount: parseInt(price) * 100, // bcoz we are gonna send the price in cents
          currency: 'usd', // i can read the docs for other currencies
          customer: customer.id,
          receipt_email: token.email, //? optional property
          description: `You have Purchased Ticket of ${events}`, //? optional property
        },
        { idempotencyKey } //? name of the key must be idempotencyKey
      );
    } catch (error) {
        return res.json({
            error: 'Error Creating Charges: ' + error
        })
    //   console.log('Error coming from creating charges: ' + error);
    }
    return res.json({
        success: chargesResult
    })
    // res.status(200).json();
}